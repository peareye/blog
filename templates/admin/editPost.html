{% extends 'admin/adminLayout.html' %}

{% block body %}
  <h2>Edit Post</h2>
  <form action="{{ pathFor('savePost') }}" method="post" accept-charset="utf-8">
    <input type="hidden" name="id" value="{{ post.id }}">
    <div class="post-button-controls">
      <a href="{{ pathFor('adminDashboard') }}" class="btn btn-default">Cancel</a>
      <button type="submit" class="btn btn-default" name="button" value="save">Save{% if not post.published_date %} Draft{% endif %}</button>

      {% if post.published_date %}
      <a href="{{ pathFor('unpublishPost', {'id': post.id}) }}" class="btn btn-warning">Unpublish</a>
      {% else %}
      <div class="btn-group">
        <button type="submit" class="btn btn-success" name="button" value="publish">Publish Now</button>
        <button type="button" class="btn btn-success dropdown-toggle" data-toggle="dropdown">
          <span class="caret"></span>
        </button>
        <ul class="dropdown-menu publish-date">
          <li>Publish Later</li>
          <li><input type="date" class="form-control" name="published_date" autocomplete="off" value="{{ post.published_date }}"></li>
        </ul>
      </div>
      {% endif %}

      {% if post.id %}
      <a href="{{ pathFor('deletePost', {'id': post.id}) }}" class="btn btn-danger deleteButton">Delete Post</a>
      {% endif %}
    </div>

    <div class="form-group">
      <label for="post-title">Title</label>
      <div class="input-group">
        <input type="text" class="form-control" name="title" maxlength="60" autocomplete="off" value="{{ post.title }}" required>
        <span class="input-group-addon"><span class="post-title-status glyphicon {% if post.title %}glyphicon-ok post-title-ok{% else %}glyphicon-question-sign{% endif %}"></span></span>
      </div>
      <p class="form-control-static post-url"><span class="glyphicon {% if post.url_locked|default('N') == 'N' %}glyphicon-unchecked{% else %}glyphicon-locked{% endif %}" title="Click to {% if post.url_locked == 'N' %}lock{% else %}unlock{% endif %} URL"></span> URL: <var>{{ post.url }}</var></p>
      <input type="hidden" name="url" value="{{ post.url }}">
      <input type="hidden" name="url_locked" value="{{ post.url_locked|default('N') }}">
    </div>

    <div class="form-group">
      <label for="post-title">Meta Description</label>
      <input type="text" class="form-control" name="meta_description" maxlength="160" autocomplete="off" value="{{ post.meta_description }}" required>
    </div>

    <div class="form-group">
      <label for="content">Content</label>
      <textarea class="form-control wysiwyg" rows="20" name="content">{{ post.content|raw }}</textarea>
    </div>
  </form>
{% endblock %}
